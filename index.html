<!DOCTYPE html>
<html lang="ru">

<head>
    <title>Играем в браузере</title>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="node_modules/shower-ribbon/styles/screen-4x3.css">
    <style>
        .slide_center {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding-top: 0;
        }
        
        .subtitle h2 {
            color: #000;
            text-align: center;
            font-size: 70px;
        }
        
    </style>
<script src="node_modules/shower-core/shower.min.js"></script>
</head>

<body class="shower list">
    <header class="caption">
        <h1>Играем в браузере</h1>
        <p>Обзорный доклад WEB-спецификаций, которые позволяют создавать игры в браузере</p>
    </header>
    <section class="slide slide_center" id="title">
        <h2>Играем в браузере</h2>
        <p><a href="http://vsesh.me">Всеволод Шмыров</a></p>
        <style>
            #title h2 {
                color: #000;
                text-align: center;
                font-size: 100px;
            }
        </style>
</section>

<section class="slide">
    <h2>Кто я такой?</h2>
    <p>Меня зовут Сева</p>
    <p class="next">Ведущий разработчик Конструктора карт Яндекса</p>
    <p class="next">В прошлом flash-разработчик игр для социальных сетей</p>
</section>

<section class="slide">
    <h2>Почему такая тема?</h2>
    <p>Внешние браузерные плагины вымирают</p>
    <p class="next">Web-спецификации наоборот предоставляют всё больше возможностей</p>
    <p class="next">Появляется всё больше готовых решений</p>
</section>

<section class="slide">
    <h2>Есть много готовых решений для HTML5-игр</h2>
    <ul>
        <li>Construct 2</li>
        <li>Unity</li>
        <li>Game Marker</li>
        <li>Pixi.js</li>
        <li>D3</li>
        <li>...</li>
    </ul>
</section>

<!-- Раздел -->
<section class="slide subtitle slide_center">
    <h2>Немного теории</h2>
</section>

<section class="slide">
    <h2>Game loop</h2>
    <img src="./pictures/gameloop.png" class="gameloop_img" />
    <style>
        .gameloop_img {
            margin: 150px auto 0px auto;
            display: block;
        }
    </style>
</section>

<section class="slide">
    <h2>requestAnimationFrame</h2>
    <pre>
            <code>function gameLoop (<mark class="mark">timestamp</mark>) {</code>
            <code class="comment">  /* recalculate */</code>
            <code class="comment">  /* redraw */</code>
            <code>  <mark class="important">requestAnimationFrame</mark>(gameLoop);</code>
            <code>}</code>
            <code>gameLoop(0);</code>
        </pre>
</section>

<section class="slide">
    <h2>Простой пример с тиком</h2>
    <p>TODO</p>
</section>

<!-- Раздел -->
<section class="slide subtitle slide_center">
    <h2>Графика</h2>
</section>

<section class="slide">
    <h2>Способы отображения игры в браузере</h2>
    <ul>
        <li>DOM</li>
        <li>Canvas</li>
        <li>SVG</li>
    </ul>
</section>

<section class="slide slide_center_content">
    <h2>DOM</h2>
    <p>TODO</p>
</section>

<section class="slide">
    <h2>Использование CSS трасформации</h2>
    <pre>
            <code>transform: <mark class="mark">scaleY</mark>(0.5);</code>
            <code>transform: <mark class="mark">rotate</mark>(45deg);</code>
        </pre>
    <div class=table-holder>
        <div class=table>
            <div class=row>
                <div class=cell></div>
                <div class=cell></div>
                <div class=cell></div>
                <div class=cell></div>
            </div>
            <div class=row>
                <div class=cell></div>
                <div class=cell></div>
                <div class=cell></div>
                <div class=cell></div>
            </div>
            <div class=row>
                <div class=cell></div>
                <div class=cell></div>
                <div class=cell></div>
                <div class=cell></div>
            </div>
            <div class=row>
                <div class=cell></div>
                <div class=cell></div>
                <div class=cell></div>
                <div class=cell></div>
            </div>
        </div>
    </div>
    <style>
            .table-holder {
                transform: translate(-50%, -50%) scaleY(0.5);
                position: absolute;
                left: 50%;
                top: calc(50% + 120px);
            }
            
            .table {
                display: table;
                border-spacing: 5px;
                transform: rotate(45deg);
            }
            
            .table .row {
                display: table-row;
            }
            
            .table .cell {
                display: table-cell;
                width: 100px;
                height: 100px;
                border: 1px solid black;
            }
        </style>
</section>

<section class="slide slide_center_content">
    <h2>Спрайтовая анимация на CSS</h2>
    <pre>
            <code>animation: <mark class="mark">play</mark> 0.5s <mark class="important">steps(6)</mark> infinite;</code>
            <code class="comment">/* Изменение свойства background-position в анимации */</code>
        </pre>
    <div class="person"></div>
    <div class="person person_animation"></div>
    <style>
            .person {
                margin: 50px auto 0px;
                width: 408px;
                height: 104px;
                background-image: url('./pictures/person.png');
            }
            
            .person_animation {
                animation: play 0.5s steps(6) infinite;
                width: 68px;
                height: 104px;
            }
            
            @keyframes play {
                0% {
                    background-position: 0px 0;
                }
                100% {
                    background-position: -408px 0;
                }
            }
        </style>
</section>

<section class="slide slide_center_content">
    <h2>Canvas</h2>
    <p>TODO</p>
</section>

<section class="slide">
    <h2>Хотспотные объекты на canvas</h2>
    <p>TODO описание, изображение</p>
</section>

<section class="slide">
    <h2>Dirty Rectangle</h2>
    <p>TODO</p>
</section>

<section class="slide">
    <h2>Canvas буфер</h2>
    <p>Canvas буфер</p>
</section>

<section class="slide slide_center_content">
    <h2>WebGL</h2>
    <p>TODO</p>
</section>

<section class="slide slide_center_content">
    <h2>SVG</h2>
    <p>TODO</p>
</section>

<section class="slide slide_center_content">
    <h2>Растеризация</h2>

    <div class="rastr_1">
        <div>
            <p>vector</p>
            <img src="./pictures/rastr1_1.png" class="rastr1_img" />
        </div>
        <div>
            <img src="./pictures/rastr1_2.png" class="rastr2_img" />
        </div>
        <div>
            <p>bitmap</p>
            <img src="./pictures/rastr1_3.png" class="rastr3_img" />
        </div>
    </div>
    <style>
        .rastr_1 {
            display: flex;
            text-align: center;
        }

        .rastr_1 > div {
            flex-grow: 1;
            height: 500px;
        }

        .rastr_1 > div:nth-child(2) {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .rastr1_img {
            height: 350px;
        }

        .rastr2_img {
            width: 100px;
            height: 100px;
        }

        .rastr3_img {
            height: 400px;
        }
    </style>
</section>

<section class="slide slide_center_content">
    <h2>Растеризация меток в API</h2>
    <p>TODO</p>
</section>

<!-- Раздел -->
<section class="slide subtitle slide_center">
    <h2>Взаимодействие с игрой</h2>
</section>

<section class="slide">
    <h2>Способы ввода</h2>
    <ul>
        <li>Клавиатура &amp; мышь</li>
        <li>Сенсорные касания</li>
        <li>Gamepad API</li>
        <li>Акселерометр</li>
        <li>Pointer Lock API</li>
    </ul>
</section>

<section class="slide">
    <h2>Сенсорные касания</h2>

    <table>
        <tr>
            <th scope="row"></th>
            <th scope="row">Touch Events</th>
            <th scope="row">Point Events</th>
        </tr>
        <tr>
            <th scope="row">Принцип</th>
            <td>Работает с жестами</td>
            <td>Работает с касаниями</td>
        </tr>
        <tr>
            <th scope="row">Разработчик</th>
            <td>Apple</td>
            <td>Microsoft</td>
        </tr>
        <tr>
            <th scope="row">Поддержка</th>
            <td>Webkit, Blink </td>
            <td>Trident, Edge, Blink</td>
        </tr>
        <tr>
            <th scope="row">Поддержка за флагом</th>
            <td>Gecko, Edge</td>
            <td>Gecko</td>
        </tr>
    </table>
</section>

<section class="slide">
    <h2>TouchEvent</h2>
    <pre>
        <code>canvas.addEventListener(<mark class="mark">'touchstart'</mark>, function(event) {</code>
        <code class="comment">    // Список всех прикосновений</code>
        <code>    event.touches;</code>
        <code>});</code>
    </pre>
</section>

<section class="slide">
    <h2>Pointer Events</h2>
    <pre>
        <code>canvas.addEventListener(<mark class="mark">'pointerdown'</mark>, function(event) {</code>
        <code class="comment">    // Обработка каждого прикосновения отдельно</code>
        <code>    event.pointerId;</code>
        <code>});</code>
    </pre>
</section>

<section class="slide">
    <h2>Приведение к единому интерфейсу</h2>
    <p>TODO пример кода</p>
</section>

<section class="slide">
    <h2>Gamepad API</h2>
    <p>Получение состояние геймпадов в браузере</p>
    <p class="next">Позволяет отслеживать нажатие кнопок, силу нажатия, положение стиков</p>
    <p class="next">Поддерживается всеми браузерами кроме IE и Safari (уже в TP)</p>
    <p class="next">Обладает непривычным интерфейсом</p>
</section>

<section class="slide">
    <h2>Интерфейс Gamepad API</h2>
    <pre>
        <code class="comment">// Нет событий нажатий кнопок, движений стиков</code>
        <code class="comment">// Нужно самому опрашивать в Game loop</code>
        <code>var gamepad = navigator.getGamepads()[0];</code>
        <code>var button0 = gp.<mark class="mark">buttons</mark>[0]; <span class="comment">/* 0-16 */</span></code>
        <code>var axe0 = gp.<mark class="mark">axes</mark>[0]; <span class="comment">/* 0-3 */</span></code>
    </pre>
</section>

<section class="slide">
    <h2> Gamepad API Show time!</h2> TODO
</section>

<section class="slide">
    <h2>Pointer Lock</h2>
    <p>TODO код с примером</p>
</section>

<section class="slide">
    <h2>Device Orientation</h2>
    <p>TODO описание, код</p>
</section>

<!-- Раздел -->
<section class="slide subtitle slide_center">
    <h2>Звук</h2>
</section>

<section class="slide">
    <h2>Web Audio API</h2>
    <p>TODO описание, изображение</p>
</section>

<!-- Раздел -->
<section class="slide subtitle slide_center">
    <h2>Сохранение игровых данных</h2>
</section>

<!-- TODO -->

<!-- Раздел -->
<section class="slide subtitle slide_center">
    <h2>Сетевая игра</h2>
</section>

<!-- TODO -->

<!-- Раздел -->
<section class="slide subtitle slide_center">
    <h2>Итог</h2>
</section>

<div class="progress"></div>
<!-- Copyright © 2015 Yours Truly, Famous Inc. -->
<!-- Photos by John Carey, fiftyfootshadows.net -->
</body>

</html>